<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JUTC SmartRide - Find Buses</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary: #1B7D3A;
      --primary-light: #2E9B52;
      --secondary: #FFD43B;
      --accent: #15aabf;
      --dark: #0a1929;
      --bg: #f5f5f5;
      --white: #ffffff;
      --text: #333;
      --text-muted: #999;
      --border: #e0e0e0;
    }

    html, body {
      height: 100%;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #d4e8e1 0%, #b8dbd4 100%);
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }

    .phone {
      width: 100%;
      max-width: 380px;
      height: 90vh;
      max-height: 900px;
      background: var(--white);
      border-radius: 40px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      box-shadow: 0 20px 60px rgba(0,0,0,0.2);
    }

    .app {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* ========== HEADER ========== */
    .header {
      padding: 20px 20px 0;
      background: var(--white);
    }

    .header-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 24px;
      font-weight: 700;
      color: var(--primary);
    }

    .logo-icon {
      width: 32px;
      height: 32px;
      background: var(--accent);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--white);
      font-weight: bold;
    }

    .profile {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ff6b6b, #ff8e72);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--white);
      font-size: 18px;
      cursor: pointer;
      border: 3px solid var(--white);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .tagline {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 16px;
    }

    .user-greeting {
      font-size: 16px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 4px;
    }

    /* ========== SCROLL CONTENT ========== */
    .scroll-content {
      flex: 1;
      overflow-y: auto;
      padding: 0 20px;
      display: flex;
      flex-direction: column;
    }

    .scroll-content::-webkit-scrollbar {
      width: 4px;
    }

    .scroll-content::-webkit-scrollbar-track {
      background: transparent;
    }

    .scroll-content::-webkit-scrollbar-thumb {
      background: #ddd;
      border-radius: 2px;
    }

    /* ========== SEARCH SECTION ========== */
    .search-section {
      margin: 20px 0;
    }

    .trip-toggle {
      display: flex;
      gap: 12px;
      margin-bottom: 16px;
    }

    .toggle-btn {
      flex: 1;
      padding: 10px 12px;
      border: none;
      background: #f0f0f0;
      color: var(--text-muted);
      border-radius: 20px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 300ms;
    }

    .toggle-btn.active {
      background: var(--primary);
      color: var(--white);
    }

    .input-group {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
      padding: 12px 16px;
      background: #f8f8f8;
      border-radius: 12px;
      border: 1px solid var(--border);
    }

    .input-group-icon {
      font-size: 18px;
      min-width: 24px;
    }

    .input-group input,
    .input-group select {
      flex: 1;
      border: none;
      background: transparent;
      font-size: 14px;
      color: var(--text);
      outline: none;
      font-family: inherit;
    }

    .input-group input::placeholder {
      color: var(--text-muted);
    }

    .flag {
      font-size: 16px;
      margin-left: 4px;
    }

    .add-return {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      color: var(--text);
      cursor: pointer;
      padding: 8px 12px;
      border-radius: 8px;
      transition: all 300ms;
    }

    .add-return:hover {
      background: #f0f0f0;
    }

    .search-btn {
      width: 100%;
      padding: 16px;
      background: var(--dark);
      color: var(--white);
      border: none;
      border-radius: 24px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 300ms;
      margin-bottom: 20px;
    }

    .search-btn:hover {
      background: #1a2332;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    /* ========== RESULTS SECTION ========== */
    .results-header {
      margin-bottom: 16px;
    }

    .results-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 4px;
    }

    .results-subtitle {
      font-size: 13px;
      color: var(--text-muted);
    }

    .results-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 20px;
    }

    .result-card {
      padding: 16px;
      background: linear-gradient(135deg, #f0f9f7 0%, #e8f4f0 100%);
      border-radius: 16px;
      border: 1px solid #d4e8e1;
      cursor: pointer;
      transition: all 300ms;
    }

    .result-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(27, 125, 58, 0.12);
    }

    .result-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .result-label {
      font-size: 12px;
      color: var(--text-muted);
      text-transform: uppercase;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    .result-price {
      font-size: 20px;
      font-weight: 700;
      color: var(--primary);
    }

    .result-detail {
      font-size: 13px;
      color: var(--text);
      margin-bottom: 4px;
    }

    .result-note {
      font-size: 12px;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* ========== CARD SECTION ========== */
    .cards-section {
      margin-bottom: 20px;
    }

    .cards-title {
      font-size: 16px;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 12px;
    }

    .smartfare-card {
      padding: 16px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      color: var(--white);
      border-radius: 16px;
      margin-bottom: 12px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    .card-type {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      opacity: 0.9;
      margin-bottom: 8px;
    }

    .card-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 6px;
    }

    .card-info {
      font-size: 13px;
      opacity: 0.95;
    }

    .card-actions {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }

    .card-btn {
      flex: 1;
      padding: 10px;
      background: rgba(255,255,255,0.2);
      border: 1px solid rgba(255,255,255,0.3);
      color: var(--white);
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 300ms;
    }

    .card-btn:hover {
      background: rgba(255,255,255,0.3);
    }

    /* ========== QR SCANNER SECTION ========== */
    .qr-section {
      margin-bottom: 20px;
    }

    .qr-btn {
      width: 100%;
      padding: 14px;
      background: var(--accent);
      color: var(--white);
      border: none;
      border-radius: 16px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 300ms;
      margin-bottom: 8px;
    }

    .qr-btn:hover {
      background: #0d95a8;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(21, 170, 191, 0.2);
    }

    .or-divider {
      text-align: center;
      font-size: 12px;
      color: var(--text-muted);
      margin: 12px 0;
      position: relative;
    }

    .or-divider::before,
    .or-divider::after {
      content: '';
      position: absolute;
      top: 50%;
      width: 40%;
      height: 1px;
      background: var(--border);
    }

    .or-divider::before {
      left: 0;
    }

    .or-divider::after {
      right: 0;
    }

    .card-input-group {
      display: flex;
      gap: 8px;
    }

    .card-input-group input {
      flex: 1;
      padding: 12px 14px;
      border: 1px solid var(--border);
      border-radius: 12px;
      font-size: 14px;
      outline: none;
      transition: all 300ms;
    }

    .card-input-group input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(27, 125, 58, 0.1);
    }

    .card-input-btn {
      padding: 12px 16px;
      background: var(--primary);
      color: var(--white);
      border: none;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 300ms;
    }

    .card-input-btn:hover {
      background: var(--primary-light);
    }

    /* ========== BOTTOM NAV ========== */
    .bottom-nav {
      background: var(--white);
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: space-around;
      align-items: center;
      height: 70px;
      padding: 8px 0;
    }

    .nav-item {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 4px;
      cursor: pointer;
      padding: 8px;
      border-radius: 12px;
      transition: all 300ms;
      color: var(--text-muted);
      font-size: 12px;
    }

    .nav-item:hover,
    .nav-item.active {
      color: var(--primary);
      background: rgba(27, 125, 58, 0.1);
    }

    .nav-icon {
      font-size: 24px;
    }

    .nav-label {
      font-size: 11px;
      font-weight: 500;
    }

    /* ========== MODALS ========== */
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: var(--white);
      border-radius: 24px;
      padding: 24px;
      max-width: 380px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
      animation: slideUp 300ms ease-out;
    }

    @keyframes slideUp {
      from {
        transform: translateY(100px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .modal-title {
      font-size: 20px;
      font-weight: 700;
      color: var(--text);
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--text-muted);
    }

    .form-group {
      margin-bottom: 16px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .form-label {
      font-size: 13px;
      font-weight: 600;
      color: var(--text);
    }

    .form-input {
      padding: 12px 14px;
      border: 1px solid var(--border);
      border-radius: 12px;
      font-size: 14px;
      outline: none;
      transition: all 300ms;
      font-family: inherit;
    }

    .form-input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(27, 125, 58, 0.1);
    }

    .modal-btn {
      width: 100%;
      padding: 14px;
      background: var(--primary);
      color: var(--white);
      border: none;
      border-radius: 16px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 300ms;
    }

    .modal-btn:hover {
      background: var(--primary-light);
      transform: translateY(-2px);
    }

    .page {
      display: none;
    }

    .page.active {
      display: flex;
      flex-direction: column;
      flex: 1;
    }

    /* QR Scanner Modal */
    .qr-scanner {
      width: 100%;
      height: 300px;
      background: var(--dark);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--white);
      font-size: 14px;
      margin-bottom: 16px;
    }

    .qr-scanner-placeholder {
      text-align: center;
    }

    .qr-scanner-icon {
      font-size: 48px;
      margin-bottom: 8px;
    }
  </style>
</head>
<body>
  <div class="phone">
    <div class="app">
      <!-- HEADER -->
      <div class="header">
        <div class="header-top">
          <div class="logo">
            <div class="logo-icon">üöå</div>
            <span>JUTC</span>
          </div>
          <div class="profile" onclick="showProfileModal()">üë§</div>
        </div>
        <div class="tagline">Find JUTC routes & schedules</div>
        <div class="user-greeting" id="userGreeting">Welcome back</div>
      </div>

      <!-- SCROLL CONTENT -->
      <div class="scroll-content">
        <!-- HOME PAGE -->
        <div class="page active" id="homePage">
          <div class="search-section">
            <div class="trip-toggle">
              <button class="toggle-btn active" onclick="setTripType('oneway')">One-way</button>
              <button class="toggle-btn" onclick="setTripType('roundtrip')">Round trip</button>
            </div>

            <div class="input-group">
              <span class="input-group-icon">üìç</span>
              <input type="text" id="fromLocation" placeholder="From location" value="Kingston, Jamaica">
              <span class="flag">üáØüá≤</span>
            </div>

            <div class="input-group">
              <span class="input-group-icon">üìç</span>
              <input type="text" id="toLocation" placeholder="To location" value="Ocho Rios">
            </div>

            <div class="input-group">
              <span class="input-group-icon">üìÖ</span>
              <input type="date" id="departDate">
              <span class="add-return" onclick="toggleReturn()">+ Add return</span>
            </div>

            <button class="search-btn" onclick="searchRoutes()">Search</button>
          </div>

          <!-- RESULTS -->
          <div class="results-header">
            <div class="results-title">Popular Routes</div>
            <div class="results-subtitle">Best fares for you</div>
          </div>

          <div class="results-list" id="resultsList">
            <div class="result-card" onclick="selectRoute('610')">
              <div class="result-card-header">
                <span class="result-label">Route 610</span>
                <span class="result-price">$150</span>
              </div>
              <div class="result-detail">Ocho Rios ‚Üí Kingston</div>
              <div class="result-note">‚≠ê Most popular | Book far in advance</div>
            </div>

            <div class="result-card" onclick="selectRoute('520')">
              <div class="result-card-header">
                <span class="result-label">Route 520</span>
                <span class="result-price">$120</span>
              </div>
              <div class="result-detail">Negril ‚Üí Kingston</div>
              <div class="result-note">üí∞ Cheapest | Premium service</div>
            </div>

            <div class="result-card" onclick="selectRoute('1')">
              <div class="result-card-header">
                <span class="result-label">Route 1</span>
                <span class="result-price">$50</span>
              </div>
              <div class="result-detail">Hellshire ‚Üí Kingston</div>
              <div class="result-note">üöå Standard | Local service</div>
            </div>
          </div>

          <!-- CARDS SECTION -->
          <div class="cards-section">
            <div class="cards-title">SmartFare Card</div>
            <div class="smartfare-card" id="smartfareCard">
              <div class="card-type">SmartFare</div>
              <div class="card-title" id="cardTitle">Adult Card</div>
              <div class="card-info" id="cardInfo">Unlimited travel on all routes</div>
              <div class="card-actions">
                <button class="card-btn" onclick="showQRScanner()">Scan Card</button>
                <button class="card-btn" onclick="showCardInput()">Add Number</button>
              </div>
            </div>
          </div>

          <!-- QR SECTION -->
          <div class="qr-section">
            <button class="qr-btn" onclick="showQRScanner()">
              <span>üì±</span>
              <span>Scan Bus Card</span>
            </button>
            <div class="or-divider">OR</div>
            <div class="card-input-group">
              <input type="text" id="cardNumber" placeholder="Enter card number" maxlength="16">
              <button class="card-input-btn" onclick="addCardNumber()">Add</button>
            </div>
          </div>
        </div>

        <!-- ROUTES PAGE -->
        <div class="page" id="routesPage">
          <div class="search-section">
            <div class="input-group">
              <span class="input-group-icon">üîç</span>
              <input type="text" id="routeSearch" placeholder="Search routes...">
            </div>
            <button class="search-btn" onclick="filterRoutes()">Search Routes</button>
          </div>

          <div id="routesList" style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 20px;"></div>
        </div>

        <!-- SAVED PAGE -->
        <div class="page" id="savedPage">
          <div class="results-header">
            <div class="results-title">Saved Routes</div>
            <div class="results-subtitle">Your favorites</div>
          </div>
          <div id="savedList" style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 20px;"></div>
        </div>
      </div>
    </div>

    <!-- BOTTOM NAV -->
    <div class="bottom-nav">
      <div class="nav-item active" onclick="switchPage('homePage')">
        <div class="nav-icon">üè†</div>
        <div class="nav-label">Home</div>
      </div>
      <div class="nav-item" onclick="switchPage('routesPage')">
        <div class="nav-icon">üö¶</div>
        <div class="nav-label">Routes</div>
      </div>
      <div class="nav-item" onclick="switchPage('savedPage')">
        <div class="nav-icon">‚≠ê</div>
        <div class="nav-label">Saved</div>
      </div>
      <div class="nav-item" onclick="showProfileModal()">
        <div class="nav-icon">üë§</div>
        <div class="nav-label">Profile</div>
      </div>
    </div>
  </div>

  <!-- PROFILE MODAL -->
  <div class="modal" id="profileModal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title">User Profile</div>
        <button class="modal-close" onclick="closeModal('profileModal')">‚úï</button>
      </div>

      <div id="profileView">
        <div style="text-align: center; margin-bottom: 20px;">
          <div style="font-size: 48px; margin-bottom: 8px;" id="userAvatar">üë§</div>
          <div style="font-size: 18px; font-weight: 700; color: var(--text);" id="userName">Not Set</div>
          <div style="font-size: 13px; color: var(--text-muted);" id="userType">Please enter your profile</div>
        </div>

        <div class="form-group" id="formSection">
          <div class="form-label">Full Name</div>
          <input type="text" id="inputName" class="form-input" placeholder="Enter your name">

          <div class="form-label">Birth Year</div>
          <select id="inputYear" class="form-input"></select>

          <div class="form-label">Birth Month (Optional)</div>
          <select id="inputMonth" class="form-input">
            <option value="">Select month</option>
            <option value="1">January</option>
            <option value="2">February</option>
            <option value="3">March</option>
            <option value="4">April</option>
            <option value="5">May</option>
            <option value="6">June</option>
            <option value="7">July</option>
            <option value="8">August</option>
            <option value="9">September</option>
            <option value="10">October</option>
            <option value="11">November</option>
            <option value="12">December</option>
          </select>

          <button class="modal-btn" onclick="saveProfile()" style="margin-top: 12px;">Save Profile</button>
        </div>
      </div>
    </div>
  </div>

  <!-- QR SCANNER MODAL -->
  <div class="modal" id="qrModal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title">Scan Bus Card</div>
        <button class="modal-close" onclick="closeModal('qrModal')">‚úï</button>
      </div>

      <div class="qr-scanner">
        <div class="qr-scanner-placeholder">
          <div class="qr-scanner-icon">üì∑</div>
          <div>Point camera at QR code</div>
        </div>
      </div>

      <div class="form-group">
        <div class="form-label">Or enter card number manually</div>
        <input type="text" id="manualCardNumber" class="form-input" placeholder="1234567890123456" maxlength="16">
      </div>

      <button class="modal-btn" onclick="processScannedCard()">Confirm Card</button>
    </div>
  </div>

  <script>
    // ========== DATA & STATE ==========
    let userProfile = null;
    let tripType = 'oneway';
    let savedRoutes = [];

    const ROUTES = [
      { route: '610', origin: 'Ocho Rios', destination: 'Kingston', price: 150, type: 'express' },
      { route: '520', origin: 'Negril', destination: 'Kingston', price: 120, type: 'express' },
      { route: '1', origin: 'Hellshire', destination: 'Kingston', price: 50, type: 'standard' },
      { route: '3', origin: 'Christian Gardens', destination: 'Kingston', price: 40, type: 'standard' },
      { route: '101', origin: 'Kingston', destination: 'Spanish Town', price: 80, type: 'premium' },
      { route: '19', origin: 'Greater Portmore', destination: 'Papine', price: 60, type: 'premium' },
    ];

    // ========== INITIALIZATION ==========
    function init() {
      const saved = localStorage.getItem('jutcProfile');
      if (saved) {
        userProfile = JSON.parse(saved);
        updateUserDisplay();
      }
      populateYearSelect();
      document.getElementById('departDate').valueAsDate = new Date();
    }

    function populateYearSelect() {
      const select = document.getElementById('inputYear');
      const currentYear = new Date().getFullYear();
      for (let year = currentYear; year >= 1950; year--) {
        const option = document.createElement('option');
        option.value = year;
        option.textContent = year;
        select.appendChild(option);
      }
    }

    // ========== USER PROFILE ==========
    function showProfileModal() {
      document.getElementById('profileModal').classList.add('active');
    }

    function closeModal(id) {
      document.getElementById(id).classList.remove('active');
    }

    function saveProfile() {
      const name = document.getElementById('inputName').value.trim();
      const year = parseInt(document.getElementById('inputYear').value);
      const month = document.getElementById('inputMonth').value;

      if (!name || !year) {
        alert('Please enter name and birth year');
        return;
      }

      const age = new Date().getFullYear() - year;
      const type = age < 18 ? 'child' : 'adult';

      userProfile = { name, year, month: month || null, age, type };
      localStorage.setItem('jutcProfile', JSON.stringify(userProfile));
      updateUserDisplay();
      closeModal('profileModal');
    }

    function updateUserDisplay() {
      if (!userProfile) return;

      document.getElementById('userGreeting').textContent = `Welcome, ${userProfile.name}! üëã`;
      document.getElementById('userName').textContent = userProfile.name;
      document.getElementById('userType').textContent = userProfile.type === 'child' ? 'üë∂ Child' : 'üë® Adult';
      document.getElementById('userAvatar').textContent = userProfile.type === 'child' ? 'üëß' : 'üë®';

      const cardTitle = userProfile.type === 'child' ? 'Child Card' : 'Adult Card';
      const cardInfo = userProfile.type === 'child'
        ? 'Special fares for children 12 and under'
        : 'Unlimited travel on all routes';

      document.getElementById('cardTitle').textContent = cardTitle;
      document.getElementById('cardInfo').textContent = cardInfo;

      if (userProfile.type === 'child') {
        document.getElementById('smartfareCard').style.background = 'linear-gradient(135deg, #2196F3 0%, #1e88e5 100%)';
      }
    }

    // ========== NAVIGATION ==========
    function switchPage(pageName) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(pageName).classList.add('active');

      document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
      event.target.closest('.nav-item')?.classList.add('active');
    }

    // ========== SEARCH & FILTER ==========
    function setTripType(type) {
      tripType = type;
      document.querySelectorAll('.toggle-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
    }

    function toggleReturn() {
      // Could add return date functionality
    }

    function searchRoutes() {
      const from = document.getElementById('fromLocation').value;
      const to = document.getElementById('toLocation').value;
      alert(`Searching routes from ${from} to ${to}`);
    }

    function selectRoute(routeNum) {
      alert(`Selected route ${routeNum}`);
      const route = ROUTES.find(r => r.route === routeNum);
      if (route) {
        savedRoutes.push(route);
        localStorage.setItem('savedRoutes', JSON.stringify(savedRoutes));
      }
    }

    function filterRoutes() {
      const search = document.getElementById('routeSearch').value.toLowerCase();
      const filtered = ROUTES.filter(r =>
        r.route.includes(search) ||
        r.origin.toLowerCase().includes(search) ||
        r.destination.toLowerCase().includes(search)
      );

      const list = document.getElementById('routesList');
      list.innerHTML = '';
      filtered.forEach(route => {
        const card = document.createElement('div');
        card.className = 'result-card';
        card.onclick = () => selectRoute(route.route);
        card.innerHTML = `
          <div class="result-card-header">
            <span class="result-label">Route ${route.route}</span>
            <span class="result-price">$${route.price}</span>
          </div>
          <div class="result-detail">${route.origin} ‚Üí ${route.destination}</div>
          <div class="result-note">${route.type.toUpperCase()}</div>
        `;
        list.appendChild(card);
      });
    }

    // ========== CARD & QR ==========
    function showQRScanner() {
      document.getElementById('qrModal').classList.add('active');
    }

    function showCardInput() {
      document.getElementById('cardNumber').focus();
    }

    function addCardNumber() {
      const number = document.getElementById('cardNumber').value;
      if (number.length === 16) {
        alert(`Card ${number.substr(-4).padStart(16, '*')} added!`);
        document.getElementById('cardNumber').value = '';
      } else {
        alert('Please enter a valid 16-digit card number');
      }
    }

    function processScannedCard() {
      const number = document.getElementById('manualCardNumber').value;
      if (number) {
        alert(`Card ${number.substr(-4).padStart(number.length, '*')} added!`);
        closeModal('qrModal');
        document.getElementById('manualCardNumber').value = '';
      }
    }

    // ========== INIT ==========
    window.addEventListener('load', init);
  </script>
</body>
</html>
